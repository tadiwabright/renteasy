<!-- templates/payments/checkout.html -->
{% extends 'base.html' %}

{% block content %}
<script src="https://js.stripe.com/v3/"></script>

<div class="payment-form">
  <form id="payment-form">
    <div id="payment-element"></div>
    <button id="submit" class="btn btn-primary">Pay Now</button>
  </form>
</div>

<script>
  const stripe = Stripe("{{ stripe_public_key }}");
  const elements = stripe.elements({clientSecret: "{{ client_secret }}"});
  const paymentElement = elements.create('payment');
  paymentElement.mount('#payment-element');
  
  const form = document.getElementById('payment-form');
  form.addEventListener('submit', async (e) => {
    e.preventDefault();
    const {error} = await stripe.confirmPayment({
      elements,
      confirmParams: {return_url: "{% url 'payment_success' %}"},
    });
  });
</script>
{% endblock %}